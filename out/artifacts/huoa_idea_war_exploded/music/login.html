<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="description" content="">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

		<!-- Title -->
		<title>Only Music</title>

		<!-- Favicon -->
		<link rel="icon" href="img/core-img/favicon.ico">

		<!-- Stylesheet -->
		<link rel="stylesheet" href="style.css">

		<style type="text/css">
			#mailbox,
			#userpwd,
			#username {
				font-size: 24px;
			}
		</style>
	</head>

	<body>
		<!-- Preloader -->
		<div class="preloader d-flex align-items-center justify-content-center">
			<div class="lds-ellipsis">
				<div></div>
				<div></div>
				<div></div>
				<div></div>
			</div>
		</div>

		<!-- ##### Header Area Start ##### -->
		<header class="header-area">
			<!-- Navbar Area -->
			<div class="oneMusic-main-menu">
				<div class="classy-nav-container breakpoint-off">
					<div class="container">
						<!-- Menu -->
						<nav class="classy-navbar justify-content-between" id="oneMusicNav">

							<!-- Nav brand -->
							<a href="index.html" class="nav-brand"><img src="img/core-img/logo.png" alt=""></a>

							<!-- Navbar Toggler -->
							<div class="">
								<span class="navbarToggler"><span></span><span></span><span></span></span>
								<input type="text" class="form-control" placeholder="搜索" style="background-color: transparent; border-radius: 20px; color: #BEE5EB;" />
							</div>

							<!-- Menu -->
							<div class="classy-menu">

								<!-- Close Button -->
								<div class="classycloseIcon">
									<div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
								</div>

								<!-- Nav Start -->
								<div class="classynav">
									<ul>
										<li><a href="index.html">主页</a></li>
										<li><a href="albums.html">专辑</a></li>
										<li><a href="#">导航栏</a>
											<ul class="dropdown">
												<li><a href="index.html">主页</a></li>
												<li><a href="albums.html">专辑</a></li>
												<li><a href="event.html">比赛</a></li>
												<li><a href="news.html">最新</a></li>
												<li><a href="contact.html">联系我们</a></li>
												<li><a href="login.html">登录</a></li>
												<li><a href="#">下载</a>
													<ul class="dropdown">
														<li><a href="#">虾米音乐</a></li>
														<li><a href="#">QQ音乐</a></li>
														<li><a href="#">网易云音乐</a></li>
														<li><a href="#">免费</a></li>
														<li><a href="#">付费专区</a>
															<ul class="dropdown">
																<li><a href="#">HD音质</a></li>
																<li><a href="#">HD音质</a></li>
																<li><a href="#">HD音质</a></li>
																<li><a href="#">HD音质</a></li>
															</ul>
														</li>
														<li><a href="#">Even Dropdown</a></li>
													</ul>
												</li>

											</ul>
										</li>
										<li><a href="event.html">比赛</a></li>
										<li><a href="news.html">最新</a></li>
										<li><a href="contact.html">联系我们</a></li>
									</ul>

									<!-- Login/Register & Cart Button -->
									<div class="login-register-cart-button d-flex align-items-center">
										<!-- Login/Register -->
										<div class="login-register-btn mr-50">
											<a href="login.html">登录 </a><span style="color: #FDFDFE;">&amp;</span>
											<a href="register.html">注册 </a>
										</div>

										<!-- Cart Button -->
										<div class="cart-btn">
											<p><span class="icon-shopping-cart"></span> <span class="quantity">1</span></p>
										</div>

										<div class="login-register-btn ml-50">
											<a href="" id="personal">Me</a>
										</div>
									</div>
								</div>
								<!-- Nav End -->

							</div>
						</nav>
					</div>
				</div>
			</div>
		</header>
		<!-- ##### Header Area End ##### -->

		<!-- ##### Breadcumb Area Start ##### -->
		<section class="breadcumb-area bg-img bg-overlay" style="background-image: url(img/bg-img/breadcumb3.jpg);">
			<div class="bradcumbContent">
				<p>专区登录</p>
				<h2>登录</h2>
			</div>
		</section>
		<!-- ##### Breadcumb Area End ##### -->

		<!-- ##### Login Area Start ##### -->
		<section class="login-area section-padding-100">
			<div class="container">
				<div class="row justify-content-center">
					<div class="col-12 col-lg-8">
						<div class="login-content">
							<h3>欢迎回来！</h3>
							<!-- Login Form -->
							<span style="color: red;" id="loginerror"></span>
							<div class="login-form">
								<form action="#" method="post">
									<div class="form-group">
										<label for="mailbox">邮件箱</label>
										<input type="email" class="form-control" id="mailbox" aria-describedby="emailHelp" placeholder="邮箱地址" name="mailbox">
										<small id="emailHelp" class="form-text text-muted"><i class="fa fa-lock mr-2"></i>我们不会透露你的邮箱</small>
									</div>
									<div class="form-group">
										<label for="userpwd">密码</label>
										<input type="password" class="form-control" id="userpwd" placeholder="密码" name="userpwd">
									</div>
									<button type="button" class="btn oneMusic-btn mt-30" id="loginBtn">登录</button>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- ##### Login Area End ##### -->

		<!-- ##### Footer Area Start ##### -->
		<footer class="footer-area">
			<div class="container">
				<div class="row d-flex flex-wrap align-items-center">
					<div class="col-12 col-md-6">
						<a href="#"><img src="img/core-img/logo.png" alt=""></a>
						<p class="copywrite-text"><a href="#"></a><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
							Copyright &copy;<script>
								document.write(new Date().getFullYear());
							</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by
							<a href="https://colorlib.com" target="_blank">Colorlib</a>
							<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
						</p>
					</div>

					<div class="col-12 col-md-6">
						<div class="footer-nav">
							<ul>
								<li><a href="index.html">主页</a></li>
								<li><a href="albums.html">专辑</a></li>
								<li><a href="event.html">比赛</a></li>
								<li><a href="news.html">新闻</a></li>
								<li><a href="contact.html">联系我们</a></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</footer>
		<!-- ##### Footer Area Start ##### -->

		<!-- ##### All Javascript Script ##### -->
		<!-- jQuery-2.2.4 js -->
		<script src="js/jquery/jquery-2.2.4.min.js"></script>
		<!-- Popper js -->
		<script src="js/bootstrap/popper.min.js"></script>
		<!-- Bootstrap js -->
		<script src="js/bootstrap/bootstrap.min.js"></script>
		<!-- All Plugins js -->
		<script src="js/plugins/plugins.js"></script>
		<!-- Active js -->
		<script src="js/active.js"></script>
		<script src="js/hu.js"></script>
		<script>
			$(function() {
				/* $("#mailbox").on("blur",function(){
					var pattern = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
					var  emailVal = $(this).val();
					alert("aa");
					if(pattern.test(emailVal){
						$("#emailHelp").html("<span style='color:green;'>√，格式正确</span>");
					}else{
						$("#emailHelp").html("<span style='color:red;'>×，格式不正确</span>");
					}
				}) */
				$("#loginBtn").click(function() {
					//没有登录过
					if (!sessionStorage.getItem("User")) {
						login();
					} else {
						var flag = window.confirm("确定要新登录？");
						if (flag) {
							window.sessionStorage.removeItem("User");
							login();
						}
					}


				});




			})


			function login() {
				var mailbox = $("#mailbox").val();
				var userpwd = $("#userpwd").val();

				if (mailbox == "" || userpwd == "") {
					alert("请输入完整正确信息");
					return;
				}
				$.ajax({
					type: "get",
					url: "http://localhost:8080/huoa/UserServlet?method=login",
					async: true,
					data: {
						mailbox: mailbox,
						userpwd: userpwd
					},
					dataType: "jsonp",
					jsonp: "jsonCallback",
					jsonpCallback: "callbackfn",

					success: function(data) {


						if (data.code == 200) {
							//如果登录成功
							alert("aaa");
							location.href = 'index.html';
							window.sessionStorage.setItem("User", JSON.stringify(data));
						} else if (data.code == 202) {
							alert("请注册");
							location.href = 'register.html';
						} else {
							$("#loginerror").html("&nbsp;&nbsp;&nbsp;用户名或密码错误");
						}

					}
				});



			}
		</script>
	
	
	</body>

</html>
